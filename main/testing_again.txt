2021-06-30 10:09:02.390569: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
Current file:CLASubjectC1511263StLRHand.mat

Creating RawArray with float64 data, n_channels=23, n_times=666800
    Range : 0 ... 666799 =      0.000 ...  3333.995 secs
Ready.
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom EEG reference.
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 6601 samples (33.005 sec)

1920 events found
Event IDs: [0 1 2 3]
Not setting metadata
Not setting metadata
636 matching events found
No baseline correction applied
0 projection items activated
Loading data for 636 events and 201 original time points ...
0 bad epochs dropped
Current file:CLASubjectC1512163StLRHand.mat

Creating RawArray with float64 data, n_channels=23, n_times=681200
    Range : 0 ... 681199 =      0.000 ...  3405.995 secs
Ready.
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom EEG reference.
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 6601 samples (33.005 sec)

1920 events found
Event IDs: [0 1 2 3]
Not setting metadata
Not setting metadata
636 matching events found
No baseline correction applied
0 projection items activated
Loading data for 636 events and 201 original time points ...
0 bad epochs dropped
Current file:CLASubjectC1512233StLRHand.mat

Creating RawArray with float64 data, n_channels=23, n_times=669400
    Range : 0 ... 669399 =      0.000 ...  3346.995 secs
Ready.
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom EEG reference.
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 6601 samples (33.005 sec)

1926 events found
Event IDs: [ 0  1  2  3 99]
Not setting metadata
Not setting metadata
635 matching events found
No baseline correction applied
0 projection items activated
Loading data for 635 events and 201 original time points ...
0 bad epochs dropped
2021-06-30 10:09:11,466	INFO services.py:1267 -- View the Ray dashboard at [1m[32mhttp://127.0.0.1:8265[39m[22m
2021-06-30 10:09:15,964	WARNING worker.py:1115 -- Warning: The actor ImplicitFunc has size 67583925 when pickled. It will be stored in Redis, which could cause memory issues. This may mean that its definition uses a large array or other object.
2021-06-30 10:09:16,109	ERROR syncer.py:72 -- Log sync requires rsync to be installed.
== Status ==
Memory usage on this node: 6.8/62.4 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 64.000: None | Iter 16.000: None | Iter 4.000: None | Iter 1.000: None
Resources requested: 1.0/56 CPUs, 1.0/1 GPUs, 0.0/37.29 GiB heap, 0.0/18.65 GiB objects (0.0/1.0 accelerator_type:P40)
Result logdir: /home/keras/ray_results/Subject_C
Number of trials: 1/1 (1 RUNNING)
+--------------------+----------+-------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+
| Trial name         | status   | loc   | activation   | batch_normalization   |   dropout_rate |   kernel_size |   learning_rate |   n_conv_layers |   n_fc_layers |   n_neurons_2nd_layer | optimizer   |   pool_size |   step_size |   temporal_filters |   window_size |
|--------------------+----------+-------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------|
| black_box_38f8d4a2 | RUNNING  |       | relu         | True                  |            0.6 |             4 |      0.00072032 |               0 |             0 |                  0.55 | adam        |           3 |         0.3 |                 30 |            50 |
+--------------------+----------+-------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+


[2m[36m(pid=376)[0m 2021-06-30 10:09:16.685993: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
[2m[36m(pid=376)[0m ---------------------------------------------------------------------------------
[2m[36m(pid=376)[0m Current configuration:
[2m[36m(pid=376)[0m window_size: 50, step_size: 15,
[2m[36m(pid=376)[0m kernel_size: 5, pool_size: 3,
[2m[36m(pid=376)[0m learning_rate: 0.0007203199754768974, temporal_filters: 30
[2m[36m(pid=376)[0m optimizer: adam, activation: relu,
[2m[36m(pid=376)[0m batch_normalization: True, n_conv_layers: 0,
[2m[36m(pid=376)[0m n_fc_layers: 0, n_neurons_2nd_layer: 0.55,
[2m[36m(pid=376)[0m dropout_rate: 0.6
[2m[36m(pid=376)[0m ---------------------------------------------------------------------------------
[2m[36m(pid=376)[0m 2021-06-30 10:09:18.873720: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.686562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
[2m[36m(pid=376)[0m pciBusID: 0000:d9:00.0 name: Tesla P40 computeCapability: 6.1
[2m[36m(pid=376)[0m coreClock: 1.531GHz coreCount: 30 deviceMemorySize: 22.38GiB deviceMemoryBandwidth: 323.21GiB/s
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.686639: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.690097: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.693685: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.694190: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.697731: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.699729: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.707073: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.708936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.709704: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
[2m[36m(pid=376)[0m To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.724623: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2200000000 Hz
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.729959: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f614891fdd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.729985: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
[2m[36m(pid=376)[0m pciBusID: 0000:d9:00.0 name: Tesla P40 computeCapability: 6.1
[2m[36m(pid=376)[0m coreClock: 1.531GHz coreCount: 30 deviceMemorySize: 22.38GiB deviceMemoryBandwidth: 323.21GiB/s
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731164: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731210: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731230: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731261: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731279: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731298: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.731317: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.732996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
[2m[36m(pid=376)[0m 2021-06-30 10:09:19.733045: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
[2m[36m(pid=376)[0m 2021-06-30 10:09:20.418819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
[2m[36m(pid=376)[0m 2021-06-30 10:09:20.418873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
[2m[36m(pid=376)[0m 2021-06-30 10:09:20.418890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
[2m[36m(pid=376)[0m 2021-06-30 10:09:20.421628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21300 MB memory) -> physical GPU (device: 0, name: Tesla P40, pci bus id: 0000:d9:00.0, compute capability: 6.1)
[2m[36m(pid=376)[0m 2021-06-30 10:09:20.424111: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f5ea3f45940 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
[2m[36m(pid=376)[0m 2021-06-30 10:09:20.424135: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P40, Compute Capability 6.1
[2m[36m(pid=376)[0m ------------------------------------------------------------------------
[2m[36m(pid=376)[0m Training for fold 1 ...
[2m[36m(pid=376)[0m 2021-06-30 10:09:21.586226: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
[2m[36m(pid=376)[0m 2021-06-30 10:09:21.815149: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
[2m[36m(pid=376)[0m 175/175 - 1s - loss: 0.5850 - accuracy: 0.7048 - val_loss: 0.5557 - val_accuracy: 0.7157
[2m[36m(pid=376)[0m --------------------------------------------------------------------------------------------------
[2m[36m(pid=376)[0m Score for fold 1: fold_val_loss of 0.5490649342536926; fold_val_accuracy of 0.7251286506652832
[2m[36m(pid=376)[0m ------------------------------------------------------------------------
[2m[36m(pid=376)[0m Training for fold 2 ...
[2m[36m(pid=376)[0m 175/175 - 1s - loss: 0.5810 - accuracy: 0.6998 - val_loss: 0.5222 - val_accuracy: 0.7657
Result for black_box_38f8d4a2:
  date: 2021-06-30_10-09-27
  done: false
  experiment_id: 90c54eb2571e4823b3faf238be5efbbe
  hostname: a3914387ca59
  iterations_since_restore: 1
  node_ip: 172.17.0.2
  pid: 376
  time_since_restore: 9.118287086486816
  time_this_iter_s: 9.118287086486816
  time_total_s: 9.118287086486816
  timestamp: 1625047767
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 38f8d4a2
  val_accuracy: 0.7283447682857513
  
== Status ==
Memory usage on this node: 9.0/62.4 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 64.000: None | Iter 16.000: None | Iter 4.000: None | Iter 1.000: 0.7283447682857513
Resources requested: 1.0/56 CPUs, 1.0/1 GPUs, 0.0/37.29 GiB heap, 0.0/18.65 GiB objects (0.0/1.0 accelerator_type:P40)
Current best trial: 38f8d4a2 with val_accuracy=0.7283447682857513 and parameters={'window_size': 50.0, 'step_size': 0.30000000000000004, 'kernel_size': 4.0, 'pool_size': 3.0, 'optimizer': 'adam', 'activation': 'relu', 'learning_rate': 0.0007203199754768974, 'temporal_filters': 30.0, 'batch_normalization': True, 'n_conv_layers': 0.0, 'n_fc_layers': 0.0, 'n_neurons_2nd_layer': 0.55, 'dropout_rate': 0.6}
Result logdir: /home/keras/ray_results/Subject_C
Number of trials: 1/1 (1 RUNNING)
+--------------------+----------+----------------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+--------+------------------+----------------+
| Trial name         | status   | loc            | activation   | batch_normalization   |   dropout_rate |   kernel_size |   learning_rate |   n_conv_layers |   n_fc_layers |   n_neurons_2nd_layer | optimizer   |   pool_size |   step_size |   temporal_filters |   window_size |   iter |   total time (s) |   val_accuracy |
|--------------------+----------+----------------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+--------+------------------+----------------|
| black_box_38f8d4a2 | RUNNING  | 172.17.0.2:376 | relu         | True                  |            0.6 |             4 |      0.00072032 |               0 |             0 |                  0.55 | adam        |           3 |         0.3 |                 30 |            50 |      1 |          9.11829 |       0.728345 |
+--------------------+----------+----------------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+--------+------------------+----------------+


[2m[36m(pid=376)[0m --------------------------------------------------------------------------------------------------
[2m[36m(pid=376)[0m Score for fold 2: fold_val_loss of 0.5340704917907715; fold_val_accuracy of 0.7315608859062195
Result for black_box_38f8d4a2:
  date: 2021-06-30_10-09-27
  done: true
  experiment_id: 90c54eb2571e4823b3faf238be5efbbe
  experiment_tag: 1_activation=relu,batch_normalization=True,dropout_rate=0.6,kernel_size=4.0,learning_rate=0.00072032,n_conv_layers=0.0,n_fc_layers=0.0,n_neurons_2nd_layer=0.55,optimizer=adam,pool_size=3.0,step_size=0.3,temporal_filters=30.0,window_size=50.0
  hostname: a3914387ca59
  iterations_since_restore: 1
  node_ip: 172.17.0.2
  pid: 376
  time_since_restore: 9.118287086486816
  time_this_iter_s: 9.118287086486816
  time_total_s: 9.118287086486816
  timestamp: 1625047767
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 38f8d4a2
  val_accuracy: 0.7283447682857513
  
== Status ==
Memory usage on this node: 8.8/62.4 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 64.000: None | Iter 16.000: None | Iter 4.000: None | Iter 1.000: 0.7283447682857513
Resources requested: 0/56 CPUs, 0/1 GPUs, 0.0/37.29 GiB heap, 0.0/18.65 GiB objects (0.0/1.0 accelerator_type:P40)
Current best trial: 38f8d4a2 with val_accuracy=0.7283447682857513 and parameters={'window_size': 50.0, 'step_size': 0.30000000000000004, 'kernel_size': 4.0, 'pool_size': 3.0, 'optimizer': 'adam', 'activation': 'relu', 'learning_rate': 0.0007203199754768974, 'temporal_filters': 30.0, 'batch_normalization': True, 'n_conv_layers': 0.0, 'n_fc_layers': 0.0, 'n_neurons_2nd_layer': 0.55, 'dropout_rate': 0.6}
Result logdir: /home/keras/ray_results/Subject_C
Number of trials: 1/1 (1 TERMINATED)
+--------------------+------------+-------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+--------+------------------+----------------+
| Trial name         | status     | loc   | activation   | batch_normalization   |   dropout_rate |   kernel_size |   learning_rate |   n_conv_layers |   n_fc_layers |   n_neurons_2nd_layer | optimizer   |   pool_size |   step_size |   temporal_filters |   window_size |   iter |   total time (s) |   val_accuracy |
|--------------------+------------+-------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+--------+------------------+----------------|
| black_box_38f8d4a2 | TERMINATED |       | relu         | True                  |            0.6 |             4 |      0.00072032 |               0 |             0 |                  0.55 | adam        |           3 |         0.3 |                 30 |            50 |      1 |          9.11829 |       0.728345 |
+--------------------+------------+-------+--------------+-----------------------+----------------+---------------+-----------------+-----------------+---------------+-----------------------+-------------+-------------+-------------+--------------------+---------------+--------+------------------+----------------+


2021-06-30 10:09:27,747	INFO tune.py:549 -- Total run time: 13.99 seconds (13.21 seconds for the tuning loop).
---------------------------------------------------------------------------------
BEST CONFIGURATION MODEL:
window_size: 50, step_size: 15,
kernel_size: 5, pool_size: 3,
learning_rate: 0.0007203199754768974, temporal_filters: 30
optimizer: adam, activation: relu,
batch_normalization: True, n_conv_layers: 0,
n_fc_layers: 0, n_neurons_2nd_layer: 0.55,
dropout_rate: 0.6
---------------------------------------------------------------------------------
2021-06-30 10:09:28.183565: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-06-30 10:09:29.941501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:d9:00.0 name: Tesla P40 computeCapability: 6.1
coreClock: 1.531GHz coreCount: 30 deviceMemorySize: 22.38GiB deviceMemoryBandwidth: 323.21GiB/s
2021-06-30 10:09:29.941581: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-06-30 10:09:29.944339: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-06-30 10:09:29.947435: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-06-30 10:09:29.947943: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-06-30 10:09:29.950836: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-06-30 10:09:29.951974: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-06-30 10:09:29.957688: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-06-30 10:09:29.962234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-06-30 10:09:29.963357: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-06-30 10:09:29.983797: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2200000000 Hz
2021-06-30 10:09:29.988664: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55da6d766910 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-30 10:09:29.988704: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-06-30 10:09:30.107685: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55da6d934050 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-06-30 10:09:30.107798: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P40, Compute Capability 6.1
2021-06-30 10:09:30.110520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:d9:00.0 name: Tesla P40 computeCapability: 6.1
coreClock: 1.531GHz coreCount: 30 deviceMemorySize: 22.38GiB deviceMemoryBandwidth: 323.21GiB/s
2021-06-30 10:09:30.110663: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-06-30 10:09:30.110783: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-06-30 10:09:30.110855: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-06-30 10:09:30.111160: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-06-30 10:09:30.111323: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-06-30 10:09:30.111402: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-06-30 10:09:30.111478: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-06-30 10:09:30.119955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-06-30 10:09:30.120080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-06-30 10:09:30.681053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-30 10:09:30.681124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-06-30 10:09:30.681140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-06-30 10:09:30.683031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21300 MB memory) -> physical GPU (device: 0, name: Tesla P40, pci bus id: 0000:d9:00.0, compute capability: 6.1)
Epoch 1/100
2021-06-30 10:09:31.909969: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-06-30 10:09:32.127730: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
350/350 - 2s - loss: 0.5493 - accuracy: 0.7191 - val_loss: 0.5039 - val_accuracy: 0.7546
Epoch 2/100
350/350 - 2s - loss: 0.4870 - accuracy: 0.7614 - val_loss: 0.4839 - val_accuracy: 0.7610
Epoch 3/100
350/350 - 2s - loss: 0.4653 - accuracy: 0.7785 - val_loss: 0.4694 - val_accuracy: 0.7785
Epoch 4/100
350/350 - 2s - loss: 0.4472 - accuracy: 0.7867 - val_loss: 0.4427 - val_accuracy: 0.7892
Epoch 5/100
350/350 - 2s - loss: 0.4310 - accuracy: 0.7922 - val_loss: 0.4435 - val_accuracy: 0.7953
Epoch 6/100
350/350 - 2s - loss: 0.4096 - accuracy: 0.8063 - val_loss: 0.4390 - val_accuracy: 0.8031
Epoch 7/100
350/350 - 2s - loss: 0.4012 - accuracy: 0.8111 - val_loss: 0.4202 - val_accuracy: 0.8024
Epoch 8/100
350/350 - 2s - loss: 0.3831 - accuracy: 0.8239 - val_loss: 0.4073 - val_accuracy: 0.8135
Epoch 9/100
350/350 - 2s - loss: 0.3712 - accuracy: 0.8322 - val_loss: 0.4017 - val_accuracy: 0.8210
Epoch 10/100
350/350 - 2s - loss: 0.3570 - accuracy: 0.8364 - val_loss: 0.4059 - val_accuracy: 0.8142
Epoch 11/100
350/350 - 2s - loss: 0.3505 - accuracy: 0.8416 - val_loss: 0.3856 - val_accuracy: 0.8242
Epoch 12/100
350/350 - 2s - loss: 0.3364 - accuracy: 0.8512 - val_loss: 0.4095 - val_accuracy: 0.8171
Epoch 13/100
350/350 - 2s - loss: 0.3180 - accuracy: 0.8590 - val_loss: 0.4019 - val_accuracy: 0.8257
Epoch 14/100
350/350 - 2s - loss: 0.3233 - accuracy: 0.8571 - val_loss: 0.3672 - val_accuracy: 0.8349
Epoch 15/100
350/350 - 2s - loss: 0.3081 - accuracy: 0.8683 - val_loss: 0.3871 - val_accuracy: 0.8310
Epoch 16/100
350/350 - 2s - loss: 0.2967 - accuracy: 0.8716 - val_loss: 0.3654 - val_accuracy: 0.8410
Epoch 17/100
350/350 - 2s - loss: 0.2969 - accuracy: 0.8723 - val_loss: 0.3774 - val_accuracy: 0.8346
Epoch 18/100
350/350 - 2s - loss: 0.2883 - accuracy: 0.8797 - val_loss: 0.3701 - val_accuracy: 0.8421
Epoch 19/100
350/350 - 2s - loss: 0.2888 - accuracy: 0.8755 - val_loss: 0.3749 - val_accuracy: 0.8374
Epoch 20/100
350/350 - 2s - loss: 0.2762 - accuracy: 0.8854 - val_loss: 0.3599 - val_accuracy: 0.8482
Epoch 21/100
350/350 - 2s - loss: 0.2720 - accuracy: 0.8838 - val_loss: 0.3644 - val_accuracy: 0.8385
Epoch 22/100
350/350 - 2s - loss: 0.2692 - accuracy: 0.8891 - val_loss: 0.3581 - val_accuracy: 0.8460
Epoch 23/100
350/350 - 2s - loss: 0.2603 - accuracy: 0.8914 - val_loss: 0.3627 - val_accuracy: 0.8435
Epoch 24/100
350/350 - 2s - loss: 0.2578 - accuracy: 0.8914 - val_loss: 0.3658 - val_accuracy: 0.8499
Epoch 25/100
350/350 - 2s - loss: 0.2568 - accuracy: 0.8921 - val_loss: 0.3713 - val_accuracy: 0.8389
Epoch 26/100
350/350 - 2s - loss: 0.2480 - accuracy: 0.8960 - val_loss: 0.3468 - val_accuracy: 0.8467
Epoch 27/100
^^C^C2021-06-30 10:10:26,164	WARNING tune.py:506 -- SIGINT received (e.g. via Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C one more time (or send SIGINT/SIGKILL/SIGTERM) to skip. 
^CTraceback (most recent call last):
  File "main.py", line 291, in <module>
    history = model.fit(data['x_train'], 
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1123, in fit
    val_logs = self.evaluate(
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1379, in evaluate
    tmp_logs = test_function(iterator)
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 814, in _call
    results = self._stateful_fn(*args, **kwds)
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/opt/conda/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
KeyboardInterrupt
^CError in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/site-packages/ray/_private/client_mode_hook.py", line 47, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/ray/worker.py", line 803, in shutdown
    time.sleep(0.5)
KeyboardInterrupt
[0m^C^C^Cterminate called without an active exception
